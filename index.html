<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Avalon Pipeline — Galaxy Edition</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
  :root{
    --ink:#e2e8f0; --ink-dim:#9fb0c6;
    --panel: rgba(9,10,15,0.65);
    --panel-strong: rgba(9,10,15,0.85);
    --glow1:#7df9ff; --glow2:#b388ff;
    --accent:#79ffe1; --accent2:#a78bfa;
  }
  html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:var(--ink);background:#090a0f;overflow-x:hidden}
  a{color:#b9dcff}
  /* Galaxy background */
  .stars{position:fixed;inset:0;z-index:-3;background:radial-gradient(ellipse at bottom,#1b2735 0%,#090a0f 100%)}
  .stars::before,.stars::after{
    content:"";position:absolute;inset:-50%;background:
      radial-gradient(2px 2px at 20% 30%,#fff 60%,transparent 61%),
      radial-gradient(1px 1px at 40% 80%,#fff 60%,transparent 61%),
      radial-gradient(2px 2px at 65% 40%,#fff 60%,transparent 61%),
      radial-gradient(1px 1px at 80% 60%,#fff 60%,transparent 61%),
      radial-gradient(1px 1px at 10% 70%,#fff 60%,transparent 61%),
      radial-gradient(2px 2px at 90% 20%,#fff 60%,transparent 61%);
    opacity:.4;animation:starDrift 260s linear infinite
  }
  .stars::after{animation-duration:320s;opacity:.5;filter:blur(.5px)}
  @keyframes starDrift{from{transform:translate(0,0)}to{transform:translate(-10%,10%)}}

  .nebula{position:fixed;inset:-50%;z-index:-2;
    background:
      radial-gradient(800px 600px at 20% 30%, rgba(138,43,226,.25), transparent 60%),
      radial-gradient(700px 700px at 75% 70%, rgba(0,191,255,.18), transparent 60%),
      radial-gradient(600px 500px at 60% 20%, rgba(255,20,147,.12), transparent 60%);
    filter:saturate(1.2) blur(0.3px);
    animation:nebulaDrift 60s ease-in-out infinite alternate;
  }
  @keyframes nebulaDrift{from{transform:translate(0,0) scale(1)}to{transform:translate(-6%,-6%) scale(1.08)}}

  /* Intro overlay */
  #intro{position:fixed;inset:0;background:#000;display:flex;align-items:center;justify-content:center;flex-direction:column;z-index:9999;overflow:hidden}
  #intro .spark{width:8px;height:8px;border-radius:50%;background:#fff;box-shadow:0 0 6px #fff,0 0 18px var(--glow1),0 0 32px var(--glow2);opacity:0;animation:sparkTwinkle .7s ease-out .1s forwards}
  #intro .line{height:2px;width:0;background:linear-gradient(90deg,transparent,#fff,transparent);filter:drop-shadow(0 0 8px #fff);opacity:0;margin:14px 0;animation:lineGrow 0.7s ease-out .55s forwards}
  #intro .burst{width:180px;height:180px;border-radius:50%;background:radial-gradient(circle,#fff 0%,#fff 30%,rgba(255,255,255,.6) 50%,transparent 70%);opacity:0;animation:burstPop .55s ease-out 1.1s forwards}
  @keyframes sparkTwinkle{0%{opacity:0;transform:scale(.4)}50%{opacity:1;transform:scale(1.1)}100%{opacity:.2;transform:scale(.8)}}
  @keyframes lineGrow{0%{opacity:0;width:0}40%{opacity:1;width:60vw}100%{opacity:0;width:0}}
  @keyframes burstPop{0%{opacity:0;transform:scale(.4)}60%{opacity:1;transform:scale(1.6)}100%{opacity:0;transform:scale(2.1)}}

  /* Layout */
  .topbar{position:sticky;top:0;z-index:20;backdrop-filter:blur(6px);background:linear-gradient(0deg,transparent,rgba(0,0,0,.55));border-bottom:1px solid rgba(255,255,255,.08)}
  .wrap{max-width:1200px;margin:0 auto;padding:16px}
  .brand{display:flex;gap:14px;align-items:center}
  .brand img{height:56px;width:auto;filter:drop-shadow(0 0 10px #fff) drop-shadow(0 0 24px var(--glow1)) drop-shadow(0 0 48px var(--glow2))}
  .brand h1{font-size:20px;font-weight:700;letter-spacing:.5px;margin:0}
  .nav{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
  .tablink{padding:8px 14px;border:1px solid rgba(255,255,255,.12);border-radius:999px;background:rgba(255,255,255,.06);cursor:pointer}
  .tablink.active{background:linear-gradient(90deg,rgba(125,249,255,.18),rgba(167,139,250,.18));border-color:rgba(255,255,255,.25);box-shadow:0 0 12px rgba(125,249,255,.3), inset 0 0 8px rgba(167,139,250,.2)}
  .content{padding:18px}
  .section{display:none;animation:fadeIn .28s ease-out}
  .section.active{display:block}
  @keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}

  /* Panels & tables */
  .panel{background:var(--panel);border:1px solid rgba(255,255,255,.12);border-radius:14px;padding:16px;box-shadow:0 8px 40px rgba(0,0,0,.4)}
  .tablewrap{overflow:auto;border-radius:12px;border:1px solid rgba(255,255,255,.1)}
  table{width:100%;border-collapse:collapse;background:var(--panel-strong)}
  th,td{padding:10px 12px;border-bottom:1px solid rgba(255,255,255,.08);vertical-align:top}
  thead th{position:sticky;top:0;background:rgba(255,255,255,.07);backdrop-filter:blur(3px)}
  td em{color:var(--ink-dim);font-style:italic}

  .controls{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:10px}
  .btn{padding:8px 12px;border:1px solid rgba(255,255,255,.2);background:rgba(255,255,255,.06);border-radius:10px;cursor:pointer}
  .btn:hover{border-color:rgba(255,255,255,.35);box-shadow:0 0 10px rgba(125,249,255,.2)}
  .input, select{padding:8px 10px;border-radius:10px;border:1px solid rgba(255,255,255,.2);background:rgba(0,0,0,.35);color:var(--ink)}
  .note{color:var(--ink-dim);font-size:12px;margin-top:6px}

  /* Collapsible form */
  details.formbox{margin-top:12px}
  details.formbox[open] summary{border-bottom-left-radius:0;border-bottom-right-radius:0}
  summary{list-style:none;cursor:pointer;padding:10px 12px;background:rgba(255,255,255,.07);border:1px solid rgba(255,255,255,.18);border-radius:10px}
  summary::marker, summary::-webkit-details-marker{display:none}
  .iframewrap{border:1px solid rgba(255,255,255,.15);border-top:0;border-bottom-left-radius:10px;border-bottom-right-radius:10px;overflow:hidden}

  /* Hidden admin */
  .adminBadge{display:none;gap:6px;align-items:center;margin-left:auto}
  .admin .adminBadge{display:flex}
  .editbar{display:none;gap:8px;margin-bottom:8px}
  .editing .editbar{display:flex}
  .ghost{opacity:.65}

  /* Toast */
  .toast{position:fixed;bottom:16px;right:16px;background:rgba(0,0,0,.7);border:1px solid rgba(255,255,255,.2);border-radius:10px;padding:10px 14px;opacity:0;transform:translateY(8px);transition:.25s}
  .toast.show{opacity:1;transform:translateY(0)}
</style>
</head>
<body>
  <!-- Galaxy -->
  <div class="stars"></div>
  <div class="nebula"></div>

  <!-- Intro -->
  <div id="intro" aria-hidden="true">
    <div class="spark"></div>
    <div class="line"></div>
    <div class="burst"></div>
  </div>

  <!-- Top bar -->
  <div class="topbar">
    <div class="wrap brand">
      <img src="avalon-logo.png" alt="Avalon Entertainment" />
      <h1>Avalon Pipeline</h1>
      <div class="adminBadge"><span class="ghost">Admin:</span>
        <button class="btn" id="toggleEdit">✏️ Edit</button>
        <button class="btn" id="saveEdit">✅ Save</button>
        <button class="btn" id="cancelEdit">✖ Cancel</button>
      </div>
      <div class="nav" id="tabs">
        <button class="tablink active" data-tab="home">Home</button>
        <button class="tablink" data-tab="fringe">Fringe Comedians</button>
        <button class="tablink" data-tab="social">Social Comedians</button>
        <button class="tablink" data-tab="plays">London Plays</button>
        <button class="tablink" data-tab="books">Books</button>
        <button class="tablink" data-tab="pitch">Pitch</button>
      </div>
    </div>
  </div>

  <div class="wrap content" id="mainContent" style="opacity:0;visibility:hidden;">
    <!-- HOME -->
    <section id="home" class="section active">
      <div class="panel">
        <h2>Welcome</h2>
        <p>Curated, development-minded tracker for talent & IP across Fringe comedy, social-first comedians, London stage, and BookTok heat — with a live pitch deck.</p>
        <p class="note">Tip: add <code>#admin</code> to the URL to reveal inline editing controls for tables (client-side, saved to your browser).</p>
      </div>
    </section>

    <!-- FRINGE -->
    <section id="fringe" class="section">
      <div class="panel">
        <div class="controls">
          <input id="fSearch" class="input" placeholder="Search name or show…" />
          <label>Min score
            <select id="fMin" class="input">
              <option value="">Any</option><option>6</option><option>7</option><option>8</option><option>9</option>
            </select>
          </label>
          <label>Sort by
            <select id="fSort" class="input">
              <option value="developPotential">Hype / Develop Potential</option>
              <option value="soldOutCount">Sold-out count</option>
              <option value="addedShows">Added shows</option>
            </select>
          </label>
          <label>Order
            <select id="fOrder" class="input"><option value="desc">Desc</option><option value="asc">Asc</option></select>
          </label>
          <button class="btn" id="fCsv">Download CSV</button>
        </div>

        <div class="editbar"><span class="ghost">Inline edit active — click table cells to edit, then “Save”.</span></div>

        <div class="tablewrap">
          <table id="fringeTbl">
            <thead>
              <tr>
                <th>Rank</th><th>Name</th><th>Show</th><th>About</th><th>Venues</th>
                <th>Agent / Contact</th><th>Reviews & Clips</th><th>Sold / Added</th><th>Score</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <details class="formbox">
          <summary>Suggest a Fringe comedian</summary>
          <div class="iframewrap">
            <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSfPsKCHb7jIQwYHdj2QPdUCzWBmX_mJ6s_ASuRJzLG1JhFxzQ/viewform?embedded=true" width="100%" height="720" frameborder="0" marginheight="0" marginwidth="0">Loading…</iframe>
          </div>
        </details>
      </div>
    </section>

    <!-- SOCIAL -->
    <section id="social" class="section">
      <div class="panel">
        <div class="controls">
          <input id="sSearch" class="input" placeholder="Search name or platform…" />
          <button class="btn" id="sCsv">Download CSV</button>
        </div>
        <div class="editbar"><span class="ghost">Inline edit active — click table cells to edit, then “Save”.</span></div>
        <div class="tablewrap">
          <table id="socialTbl">
            <thead>
              <tr><th>Name</th><th>Primary Platform</th><th>Followers (approx)</th><th>Engagement (est)</th><th>Links</th><th>Notes</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <details class="formbox">
          <summary>Suggest a social-first comedian</summary>
          <div class="iframewrap">
            <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSfrxIb-kATP7eo6HTwlLBLDC3cNS1xof_Ts2UJ7Wur2yAwuJw/viewform?embedded=true" width="100%" height="720" frameborder="0" marginheight="0" marginwidth="0">Loading…</iframe>
          </div>
        </details>
      </div>
    </section>

    <!-- PLAYS -->
    <section id="plays" class="section">
      <div class="panel">
        <div class="controls">
          <input id="pSearch" class="input" placeholder="Search title, playwright, theatre…" />
          <button class="btn" id="pCsv">Download CSV</button>
        </div>
        <div class="editbar"><span class="ghost">Inline edit active — click table cells to edit, then “Save”.</span></div>
        <div class="tablewrap">
          <table id="playsTbl">
            <thead>
              <tr><th>Title</th><th>Playwright</th><th>Director</th><th>Theatre</th><th>Dates</th><th>Links</th><th>Notes</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <details class="formbox">
          <summary>Suggest a London play</summary>
          <div class="iframewrap">
            <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSflXbVZyY5wlAd4-qScZOKVY8iYYhsOR65aaGOTetHf1dtVgg/viewform?embedded=true" width="100%" height="720" frameborder="0" marginheight="0" marginwidth="0">Loading…</iframe>
          </div>
        </details>
      </div>
    </section>

    <!-- BOOKS -->
    <section id="books" class="section">
      <div class="panel">
        <div class="controls">
          <input id="bSearch" class="input" placeholder="Search title or author…" />
          <button class="btn" id="bCsv">Download CSV</button>
        </div>
        <div class="editbar"><span class="ghost">Inline edit active — click table cells to edit, then “Save”.</span></div>
        <div class="tablewrap">
          <table id="booksTbl">
            <thead>
              <tr><th>Title</th><th>Author</th><th>Genre</th><th>Links</th><th>Notes</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <details class="formbox">
          <summary>Suggest a book</summary>
          <div class="iframewrap">
            <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSchL7IzTz-fimHhkUFH3GuhmOvClGe9k9x0TSzDImNyig_5tg/viewform?embedded=true" width="100%" height="720" frameborder="0" marginheight="0" marginwidth="0">Loading…</iframe>
          </div>
        </details>
      </div>
    </section>

    <!-- PITCH -->
    <section id="pitch" class="section">
      <div class="panel">
        <h2>Pitch — Mockumentary × Sketch: “Algorithm Approved” (WT)</h2>
        <h3>Logline</h3>
        <p><em>A fast-cut mockumentary set inside a fictional social platform where creators, managers and interns chase the algorithm — a sketch hybrid made for TV and endlessly sliceable for TikTok/YouTube.</em></p>

        <h3>Background (influencer comedy landscape)</h3>
        <ul>
          <li><strong>Influencers are the new celebrities</strong> — built-in audiences &amp; immediate reach.</li>
          <li><strong>Sketch gap on UK TV</strong> — youth-skewing, digital-first revival opportunity.</li>
          <li>Precedent: <em>#HoodDocumentary</em> (BBC Three) → digital-to-TV pathway, enduring meme impact.</li>
        </ul>

        <h3>Why Avalon / market fit</h3>
        <ul>
          <li>Digital-first pipeline: short clips (40–90s) + 20–25min episode package.</li>
          <li>Low-cost production model, scalable with demand.</li>
          <li>Dual monetisation (platform ads &amp; broadcast window).</li>
        </ul>

        <h3>Series concept</h3>
        <p>Mock-doc interviews + quick sketches inside “Instangram” (WT): creator wars, brand cringe, “authenticity metrics,” and algorithm panic. Repeatable workplace-world + rotating guest stars.</p>

        <h3>Talent pool (examples)</h3>
        <ul>
          <li><strong>Digital anchors:</strong> Munya Chawawa, Lucia Keskin, Tyrell Charles, Max Fosh, Niko Omilana, Amelia Dimoldenberg (availability TBD).</li>
          <li><strong>Fringe alums for character work:</strong> Ayo Adenekan, Sam Nicoresti, Ayoade Bamgboye, Cat Cohen, Toussaint Douglass.</li>
        </ul>

        <h3>Prototype ask</h3>
        <p>60–120s sizzle: two sketches + confessional, shot in an office with phone + A-cam. Social KPIs prove demand before scaling.</p>
      </div>
    </section>
  </div>

  <div class="toast" id="toast">Saved</div>

<script>
/* ---------- UTIL ---------- */
const qs = s=>document.querySelector(s);
const qsa = s=>Array.from(document.querySelectorAll(s));
function toast(msg='Saved'){const t=qs('#toast');t.textContent=msg;t.classList.add('show');setTimeout(()=>t.classList.remove('show'),1500);}
function csvDownload(filename, rows, headers){
  const data=[headers,...rows].map(r=>r.map(c=>`"${String(c??'').replace(/"/g,'""')}"`).join(',')).join('\n');
  const blob=new Blob([data],{type:'text/csv'}), url=URL.createObjectURL(blob);
  const a=document.createElement('a'); a.href=url; a.download=filename; a.click(); URL.revokeObjectURL(url);
}
function escapeHtml(s){return String(s??'').replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;');}

/* ---------- INTRO REVEAL ---------- */
function revealMain(){qs('#intro').style.display='none';const mc=qs('#mainContent');mc.style.opacity='1';mc.style.visibility='visible';}
window.addEventListener('load',()=>{ setTimeout(revealMain,1400); });

/* ---------- TABS ---------- */
qsa('.tablink').forEach(btn=>{
  btn.addEventListener('click',()=>{
    qsa('.tablink').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    qsa('.section').forEach(s=>s.classList.remove('active'));
    qs('#'+btn.dataset.tab).classList.add('active');
    history.replaceState(null,'','#'+btn.dataset.tab);
  });
});
if(location.hash){const h=location.hash.slice(1);const t=qs(`.tablink[data-tab="${h}"]`); if(t) t.click();}
document.body.classList.toggle('admin', location.hash.includes('admin'));

/* ---------- DATA ---------- */
/* Fringe comedians — 12 entries with depth */
const FRINGE_DEFAULT = [
  {"id":1,"name":"Ayo Adenekan","show":"Black Mediocrity","about":"Personal storytelling about growing up Black & queer in Edinburgh.","agent":"Appears to be Unagented","email":"ayoadenekan767@gmail.com","venues":"Monkey Barrel / Brass Tacks / The Tron","soldOutCount":22,"addedShows":3,"review":"https://festmag.com/2025/08/03/review-ayo-adenekan-black-mediocrity/","clip":"https://www.tiktok.com/@zai_swanzy/video/7539470786516634902","developPotential":8,"notes":"Strong local sell-outs; warm, character-led writing — good for live special or pilot development."},
  {"id":2,"name":"Toussaint Douglass","show":"Accessible Pigeon Material","about":"Eccentric, prop-driven debut mixing pigeons, family and neurodivergence.","agent":"UTC Artist Management (listed)","email":"(agent via UTC)","venues":"Pleasance Courtyard / Bunker One","soldOutCount":"","addedShows":"","review":"https://www.theguardian.com/stage/2025/aug/08/toussaint-douglass-accessible-pigeon-material-review-pleasance-courtyard-edinburgh","clip":"https://www.youtube.com/results?search_query=Toussaint+Douglass+Accessible+Pigeon+Material","developPotential":7,"notes":"Inventive prop work and distinct voice — good for character-led sketch development."},
  {"id":3,"name":"Amelia Hamilton","show":"Forget Me Not","about":"Gen-Z rap-comedy hybrid using original music and quick gags.","agent":"Appears to be Unagented","email":"amelialouisehamilton@gmail.com","venues":"Pleasance Courtyard (Attic)","soldOutCount":"","addedShows":"","review":"https://www.chortle.co.uk/review/2025/08/01/58633/amelia_hamilton%3A_forget_me_not","clip":"https://www.youtube.com/results?search_query=Amelia+Hamilton+Forget+Me+Not","developPotential":6,"notes":"Musical/character bits could expand into sketches or a short-form series."},
  {"id":4,"name":"Ola Labib","show":"Dispersible","about":"Ex-NHS pharmacist: sharp satire on TV industry & diaspora life.","agent":"UTC Artist Management","email":"(publicist via listings)","venues":"Soho Theatre / circuits","soldOutCount":"","addedShows":"","review":"https://sohotheatre.com/events/ola-labib-dispersible/","clip":"https://www.youtube.com/watch?v=K3_oxIzhrF4","developPotential":9,"notes":"Has TV credits; candidate for scripted comedy development."},
  {"id":5,"name":"Cat Cohen","show":"Broad Strokes","about":"Cabaret-comedy blend: songs + stand-up and character work with big stagecraft.","agent":"CAA (US)","email":"(via site)","venues":"Pleasance Courtyard / cabaret slots","soldOutCount":"","addedShows":"","review":"https://www.theguardian.com/stage/2025/aug/06/cat-cohen-broad-strokes-review-pleasance-courtyard-edinburgh","clip":"https://www.youtube.com/results?search_query=Cat+Cohen+comedy","developPotential":8,"notes":"Musical storytelling—good for live special or hybrid TV format."},
  {"id":6,"name":"Ayoade Bamgboye","show":"Swings and Roundabouts","about":"Commanding debut mixing accents, character work and dramatic comedy.","agent":"Independent Talent Group","email":"(via ITG)","venues":"Pleasance Courtyard","soldOutCount":"","addedShows":"","review":"https://www.theguardian.com/stage/2025/aug/17/ayoade-bamgboye-swings-and-roundabouts-review-commanding-comics-thrilling-debut","clip":"https://www.edfringe.com/tickets/whats-on/ayoade-bamgboye-swings-and-roundabouts","developPotential":9,"notes":"Best Newcomer buzz & theatrical range — prime for scripted development."},
  {"id":7,"name":"Sam Nicoresti","show":"Baby Doomer","about":"High-joke-density stand-up with emotional core; trans experience & PTSD.","agent":"Ebdon Management","email":"(via Ebdon)","venues":"Pleasance Courtyard","soldOutCount":"","addedShows":"","review":"https://www.theguardian.com/stage/2025/aug/16/sam-nicoresti-review-pleasance-courtyard-edinburgh","clip":"https://www.youtube.com/results?search_query=Sam+Nicoresti+Baby+Doomer","developPotential":9,"notes":"Major award attention — strong profile for specials & development."},
  {"id":8,"name":"Ryan Mold","show":"Breaking the Mold","about":"Confident storyteller about family, grief and working-class life.","agent":"Appears to be Unagented","email":"(via Fringe/venue)","venues":"Hanover Tap / Fringe rooms","soldOutCount":"","addedShows":"","review":"https://theqr.co.uk/2025/08/29/edfringe-review-ryan-mold-breaking-the-mold/","clip":"https://www.edfringe.com/tickets/whats-on/ryan-mold-breaking-the-mold","developPotential":6,"notes":"Solid audience-work; good for hosting Avalon live nights."},
  {"id":9,"name":"Britt Migs","show":"Dolphin Mode","about":"Dark, energetic debut mixing personal trauma and musical staging.","agent":"Appears to be Unagented","email":"(via Fringe)","venues":"Buttercup / Fringe rooms","soldOutCount":"","addedShows":"","review":"https://theqr.co.uk/2025/07/31/edfringe-review-britt-migs-dolphin-mode/","clip":"https://www.youtube.com/results?search_query=Britt+Migs+comedy","developPotential":6,"notes":"Distinct performative identity; good for alt cabaret or character shorts."},
  {"id":10,"name":"Dylan Adler","show":"Haus of Dy-lan","about":"Theatrical musical-comedy with big staging and feminist overtones.","agent":"CAA","email":"(via listing)","venues":"Cabaret rooms","soldOutCount":"","addedShows":"","review":"https://www.bingefringe.com/2025/08/28/review-haus-of-dy-lan-dylan-adler-edfringe-2025/","clip":"https://www.youtube.com/results?search_query=Dylan+Adler+Haus+of+Dy-lan","developPotential":7,"notes":"Theatrical energy & musical chops — good hybrid short."},
  {"id":11,"name":"Pedro Leandro","show":"Soft Animal","about":"Polished debut: actor-comic crossover exploring queer identity & validation.","agent":"Independent Talent Group","email":"(via ITG)","venues":"BIGHEAD Comedy / assoc. with ITG","soldOutCount":"","addedShows":"","review":"https://www.bingefringe.com/2025/08/19/review-pedro-leandro-soft-animal-bighead-comedy-in-association-with-independent-talent-group-edfringe-2025/","clip":"https://www.youtube.com/watch?v=il1KdpeMPK4","developPotential":7,"notes":"Actor/comic crossover — good for comedy-drama roles."},
  {"id":12,"name":"Elouise Eftos","show":"Australia's First Attractive Comedian","about":"Provocative, theatrical debut — feminist, performance-led.","agent":"Century Comedy (AU)","email":"(via listing)","venues":"Pleasance Courtyard (Below)","soldOutCount":"","addedShows":"","review":"https://www.theguardian.com/stage/2025/aug/21/elouise-eftos-australias-first-attractive-comedian-review-fabulously-provocative-jokes","clip":"https://www.edfringe.com/tickets/whats-on/elouise-eftos-australias-first-attractive-comedian","developPotential":8,"notes":"Award buzz in AU — good for international showcases."}
];

/* Social comedians (starter set; numbers indicative) */
const SOCIAL_DEFAULT = [
  {"name":"Munya Chawawa","platform":"Instagram/TikTok/YouTube","followers":"3M+ combined","engagement":"High (satire/sketch)","links":"https://www.instagram.com/munyachawawa/","notes":"Viral topical satire; crossover TV credits."},
  {"name":"Lucia Keskin (Chi with a C)","platform":"YouTube/Instagram","followers":"1M+","engagement":"High (character)","links":"https://www.youtube.com/@chiwithac/","notes":"Character-led; BBC crossovers."},
  {"name":"Tyrell Charles","platform":"TikTok/Instagram","followers":"1M+","engagement":"High","links":"https://www.tiktok.com/@tyrell.charles","notes":"POV sketches; strong retention."},
  {"name":"Max Fosh","platform":"YouTube","followers":"2M+","engagement":"Med-High","links":"https://www.youtube.com/@MaxFosh","notes":"Situational stunts; docu-comedy potential."},
  {"name":"Niko Omilana","platform":"YouTube","followers":"6M+","engagement":"High","links":"https://www.youtube.com/@Niko","notes":"Satirical stunts; large youth reach."},
  {"name":"Amelia Dimoldenberg","platform":"YouTube/IG","followers":"3M+","engagement":"High","links":"https://www.youtube.com/@chicken_shop_date","notes":"Interview comedy; strong brand collabs."},
  {"name":"Safro","platform":"Instagram/TikTok","followers":"500k+","engagement":"High","links":"https://www.instagram.com/safrosatire/","notes":"Character satire; shortform native."},
  {"name":"Joanita Brown","platform":"Instagram/TikTok","followers":"300k+","engagement":"High","links":"https://www.instagram.com/joanitabrownofficial/","notes":"Strong repeatable characters."}
];

/* London plays (sample) */
const PLAYS_DEFAULT = [
  {"title":"The Motive and the Cue","playwright":"Jack Thorne","director":"Sam Mendes","theatre":"Noël Coward Theatre","dates":"Current Run","links":"https://www.noelcowardtheatre.co.uk/","notes":"Behind-the-scenes drama; awards buzz."},
  {"title":"Standing at the Sky’s Edge","playwright":"Chris Bush (book)","director":"Robert Hastie","theatre":"Gillian Lynne Theatre","dates":"Current Run","links":"https://lwtheatres.co.uk/","notes":"Musical; contemporary, critical hit."},
  {"title":"The Effect","playwright":"Lucy Prebble","director":"Jamie Lloyd","theatre":"National Theatre (Lyttelton)","dates":"Current/Returning","links":"https://www.nationaltheatre.org.uk/","notes":"Relationship+science; sleek staging."},
  {"title":"Nye","playwright":"Tim Price","director":"Rufus Norris","theatre":"National Theatre","dates":"Season","links":"https://www.nationaltheatre.org.uk/","notes":"Biographical drama; political resonance."},
  {"title":"The Play That Goes Wrong","playwright":"Mischief","director":"Mark Bell","theatre":"Duchess Theatre","dates":"Ongoing","links":"https://www.theplaythatgoeswrong.com/","notes":"Long-running farce; mainstream appeal."}
];

/* Books (BookTok heat) */
const BOOKS_DEFAULT = [
  {"title":"Fourth Wing","author":"Rebecca Yarros","genre":"Romantasy","links":"https://www.goodreads.com/book/show/61431922","notes":"BookTok juggernaut; TV rights buzz."},
  {"title":"Iron Flame","author":"Rebecca Yarros","genre":"Romantasy","links":"https://www.goodreads.com/book/show/61431924","notes":"Sequel momentum; huge fandom."},
  {"title":"Yellowface","author":"R.F. Kuang","genre":"Literary satire","links":"https://www.goodreads.com/book/show/62884860","notes":"Media discourse; adaptation chatter."},
  {"title":"The Seven Husbands of Evelyn Hugo","author":"Taylor Jenkins Reid","genre":"Historical/romance","links":"https://www.goodreads.com/book/show/32620332","notes":"Sustained social buzz; screen dev interest."},
  {"title":"A Court of Thorns and Roses","author":"Sarah J. Maas","genre":"Fantasy romance","links":"https://www.goodreads.com/book/show/16096824","notes":"Massive series; evergreen TikTok presence."}
];

/* ---------- STATE (localStorage-backed) ---------- */
function loadState(key, fallback){ try{ const raw=localStorage.getItem(key); return raw? JSON.parse(raw): structuredClone(fallback);}catch{ return structuredClone(fallback); } }
let FRINGE = loadState('avalon_fringe', FRINGE_DEFAULT);
let SOCIAL = loadState('avalon_social', SOCIAL_DEFAULT);
let PLAYS  = loadState('avalon_plays',  PLAYS_DEFAULT);
let BOOKS  = loadState('avalon_books',  BOOKS_DEFAULT);

/* ---------- RENDERERS ---------- */
function renderFringe(){
  const q = qs('#fSearch').value.toLowerCase();
  const min = Number(qs('#fMin').value) || 0;
  const sortBy = qs('#fSort').value; const order = qs('#fOrder').value;
  let rows = FRINGE.filter(d => (d.name+d.show).toLowerCase().includes(q));
  rows = rows.filter(d => (+d.developPotential||0) >= min);
  rows.sort((a,b)=>{
    const A = (a[sortBy]??0)||0; const B=(b[sortBy]??0)||0;
    return order==='desc' ? (B-A) : (A-B);
  });
  const tb = qs('#fringeTbl tbody'); tb.innerHTML='';
  rows.forEach((d,i)=>{
    const tr=document.createElement('tr');
    tr.innerHTML = `
      <td>${i+1}</td>
      <td contenteditable>${escapeHtml(d.name)}</td>
      <td contenteditable><em>${escapeHtml(d.show)}</em></td>
      <td contenteditable>${escapeHtml(d.about)}<div class="note"><em>${escapeHtml(d.notes||'')}</em></div></td>
      <td contenteditable>${escapeHtml(d.venues||'')}</td>
      <td contenteditable>${escapeHtml(d.agent||'')}<div class="note">${escapeHtml(d.email||'')}</div></td>
      <td>
        <div><a target="_blank" href="${d.review}">Read review</a></div>
        <div><a target="_blank" href="${d.clip}">Watch clip / listing</a></div>
      </td>
      <td contenteditable>${d.soldOutCount||'—'} / ${d.addedShows||'—'}</td>
      <td contenteditable>${d.developPotential||''}</td>`;
    tr.dataset.id = d.id;
    tb.appendChild(tr);
  });
}
function renderSocial(){
  const q=qs('#sSearch').value.toLowerCase(), tb=qs('#socialTbl tbody'); tb.innerHTML='';
  SOCIAL.filter(d=>(d.name+d.platform).toLowerCase().includes(q)).forEach(d=>{
    const tr=document.createElement('tr');
    tr.innerHTML = `
      <td contenteditable>${escapeHtml(d.name)}</td>
      <td contenteditable>${escapeHtml(d.platform)}</td>
      <td contenteditable>${escapeHtml(d.followers)}</td>
      <td contenteditable>${escapeHtml(d.engagement)}</td>
      <td contenteditable><a target="_blank" href="${d.links}">${escapeHtml(d.links)}</a></td>
      <td contenteditable><em>${escapeHtml(d.notes||'')}</em></td>`;
    tb.appendChild(tr);
  });
}
function renderPlays(){
  const q=qs('#pSearch').value.toLowerCase(), tb=qs('#playsTbl tbody'); tb.innerHTML='';
  PLAYS.filter(d=>(d.title+d.playwright+d.theatre).toLowerCase().includes(q)).forEach(d=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`
      <td contenteditable>${escapeHtml(d.title)}</td>
      <td contenteditable>${escapeHtml(d.playwright)}</td>
      <td contenteditable>${escapeHtml(d.director||'')}</td>
      <td contenteditable>${escapeHtml(d.theatre)}</td>
      <td contenteditable>${escapeHtml(d.dates||'')}</td>
      <td contenteditable><a target="_blank" href="${d.links}">${escapeHtml(d.links)}</a></td>
      <td contenteditable><em>${escapeHtml(d.notes||'')}</em></td>`;
    tb.appendChild(tr);
  });
}
function renderBooks(){
  const q=qs('#bSearch').value.toLowerCase(), tb=qs('#booksTbl tbody'); tb.innerHTML='';
  BOOKS.filter(d=>(d.title+d.author).toLowerCase().includes(q)).forEach(d=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`
      <td contenteditable>${escapeHtml(d.title)}</td>
      <td contenteditable>${escapeHtml(d.author)}</td>
      <td contenteditable>${escapeHtml(d.genre)}</td>
      <td contenteditable><a target="_blank" href="${d.links}">${escapeHtml(d.links)}</a></td>
      <td contenteditable><em>${escapeHtml(d.notes||'')}</em></td>`;
    tb.appendChild(tr);
  });
}

/* ---------- BINDINGS ---------- */
['fSearch','fMin','fSort','fOrder'].forEach(id=>qs('#'+id).addEventListener('input',renderFringe));
qs('#fCsv').addEventListener('click',()=>{
  const rows = FRINGE.map(d=>[d.name,d.show,d.about,d.agent,d.email,d.venues,d.soldOutCount||'',d.addedShows||'',d.review,d.clip,d.developPotential,d.notes]);
  csvDownload('fringe.csv', rows, ["Name","Show","About","Agent","Email","Venues","SoldOut","Added","Review","Clip","Score","Notes"]);
});
qs('#sSearch').addEventListener('input',renderSocial);
qs('#sCsv').addEventListener('click',()=>{
  const rows = SOCIAL.map(d=>[d.name,d.platform,d.followers,d.engagement,d.links,d.notes]);
  csvDownload('social-comedians.csv', rows, ["Name","Platform","Followers","Engagement","Links","Notes"]);
});
qs('#pSearch').addEventListener('input',renderPlays);
qs('#pCsv').addEventListener('click',()=>{
  const rows = PLAYS.map(d=>[d.title,d.playwright,d.director||'',d.theatre,d.dates||'',d.links,d.notes||'']);
  csvDownload('london-plays.csv', rows, ["Title","Playwright","Director","Theatre","Dates","Links","Notes"]);
});
qs('#bSearch').addEventListener('input',renderBooks);
qs('#bCsv').addEventListener('click',()=>{
  const rows = BOOKS.map(d=>[d.title,d.author,d.genre,d.links,d.notes]);
  csvDownload('books.csv', rows, ["Title","Author","Genre","Links","Notes"]);
});

/* ---------- ADMIN INLINE EDIT ---------- */
const isAdmin = location.hash.includes('admin');
if(isAdmin){
  document.body.classList.add('admin');
  let editing=false;
  const toggle=()=>{ editing=!editing; document.body.classList.toggle('editing',editing); qsa('[contenteditable]').forEach(el=>el.setAttribute('contenteditable',editing?'true':'false')); };
  qs('#toggleEdit').addEventListener('click',toggle);
  qs('#cancelEdit').addEventListener('click',()=>{ editing=false; document.body.classList.remove('editing'); qsa('[contenteditable]').forEach(el=>el.setAttribute('contenteditable','false')); renderAll(); });
  qs('#saveEdit').addEventListener('click',()=>{
    // Re-scan tables back into arrays (simple mapper by column order)
    // Fringe
    const fRows = qsa('#fringeTbl tbody tr');
    FRINGE = Array.from(fRows).map((tr,idx)=>{
      const tds = tr.children;
      const name = tds[1].innerText.trim();
      const show = tds[2].innerText.trim().replace(/^(\*|_)?|(\*|_)?$/g,'');
      const about = tds[3].childNodes[0].textContent.trim();
      const notes = (tds[3].querySelector('.note')?.innerText||'').replace(/^(\*|_)?|(\*|_)?$/g,'');
      const venues = tds[4].innerText.trim();
      const agentBlock = tds[5].innerText.trim().split('\n');
      const agent = agentBlock[0]||'';
      const email = agentBlock[1]||'';
      const soldAdded = tds[7].innerText.trim();
      const [soldOutCount, addedShows] = soldAdded.split('/').map(s=>s? s.trim(): '');
      const score = tds[8].innerText.trim();
      const review = tr.querySelector('td:nth-child(7) a:nth-child(1)')?.getAttribute('href')||'';
      const clip = tr.querySelector('td:nth-child(7) a:nth-child(2)')?.getAttribute('href')||'';
      return { id: idx+1, name, show, about, agent, email, venues, soldOutCount, addedShows, review, clip, developPotential: score, notes };
    });
    localStorage.setItem('avalon_fringe', JSON.stringify(FRINGE));

    // Social
    const sRows = qsa('#socialTbl tbody tr');
    SOCIAL = Array.from(sRows).map(tr=>{
      const tds=tr.children;
      return { name:tds[0].innerText.trim(), platform:tds[1].innerText.trim(), followers:tds[2].innerText.trim(), engagement:tds[3].innerText.trim(), links:tds[4].innerText.trim(), notes:tds[5].innerText.trim() };
    });
    localStorage.setItem('avalon_social', JSON.stringify(SOCIAL));

    // Plays
    const pRows = qsa('#playsTbl tbody tr');
    PLAYS = Array.from(pRows).map(tr=>{
      const tds=tr.children;
      return { title:tds[0].innerText.trim(), playwright:tds[1].innerText.trim(), director:tds[2].innerText.trim(), theatre:tds[3].innerText.trim(), dates:tds[4].innerText.trim(), links:tds[5].innerText.trim(), notes:tds[6].innerText.trim() };
    });
    localStorage.setItem('avalon_plays', JSON.stringify(PLAYS));

    // Books
    const bRows = qsa('#booksTbl tbody tr');
    BOOKS = Array.from(bRows).map(tr=>{
      const tds=tr.children;
      return { title:tds[0].innerText.trim(), author:tds[1].innerText.trim(), genre:tds[2].innerText.trim(), links:tds[3].innerText.trim(), notes:tds[4].innerText.trim() };
    });
    localStorage.setItem('avalon_books', JSON.stringify(BOOKS));

    toast('Saved to your browser (localStorage)');
    toggle();
    renderAll();
  });

  // ESC cancels edit
  document.addEventListener('keydown',e=>{ if(e.key==='Escape' && document.body.classList.contains('editing')) qs('#cancelEdit').click(); });
}else{
  // Lock contenteditable off for public
  qsa('[contenteditable]').forEach(el=>el.setAttribute('contenteditable','false'));
}

/* ---------- INITIAL RENDER ---------- */
function renderAll(){ renderFringe(); renderSocial(); renderPlays(); renderBooks(); }
renderAll();
</script>
</body>
</html>
